// Generated by CoffeeScript 1.10.0
$(function() {
  var clipboard, clipboard1,couponRequisitionedIndex, textTipsIndex;
  clipboard = new Clipboard('.goods-pic', {
    target: function() {
      var url='/?g=tbkqq&m=list&a=gettpl&id='+ obj.siblings('.go_info').data('gid') ;
      $.ajax({
        type:'get',
        url:url,
        cache:false,
        success:function(res){

          html = '<div id="copy-input">'+res+'</div>';
          // obj.find('img').attr('src',obj.siblings('a').find('img').attr('src'));

        },
        errer:function(){
        }
      });
      $('#copy-input').remove();
      $('body').append(html);
      return document.getElementById('copy-input');
    }
  });
  clipboard.on('success', function(e) {
    return layer.msg('已复制');
  });
  clipboard.on('error', function(e) {
    return layer.msg('您的浏览器不支持一键复制，请升级浏览器或更换浏览器');
  });

  textTipsIndex = null;

  $('.goods-pic').mouseenter(function() {
    var  html,no, img, liTag, txt;
//    $(this).text('复制');
    txt = $(this).attr('data-text');
    txt = txt.replace(/\n/ig, "<br/>");
    liTag = $(this).parents('li');
    no = $(liTag).attr('data-no');

    img = $(liTag).attr('data-img');
    html = "<div id='copy-input' style='width: 1px;height: 1px;overflow: hidden'><img style='width: 290px;height: 290px;' src='" + img + "'>"+no +"<br/>" +  txt + "</div>";
    textTipsIndex = layer.tips(txt, this, {
      time: 0,
      area: ['500px']
    });


    $('#copy-input').remove();
    return $('body').append(html);
  });
  $('.goods-pic').mouseleave(function() {
    layer.close(textTipsIndex);
    return;
  });




  clipboard1 = new Clipboard('.body', {
    target: function() {
      return document.getElementById('copy-input');
    }
  });
  clipboard1.on('success', function(e) {
    return layer.msg('已复制');
  });
  clipboard1.on('error', function(e) {
    return layer.msg('您的浏览器不支持一键复制，请升级浏览器或更换浏览器');
  });

//  textTipsIndex = null;

  $('.body').mouseenter(function() {
    var html,no, txt;
//    $(this).text('复制');
    txt = $(this).attr('data-text');
    txt = txt.replace(/\n/ig, "<br/>");
    no = $(this).attr('data-no');
//    img = $(liTag).attr('data-img');
    html = "<div id='copy-input' style='width: 1px;height: 1px;overflow: hidden'>" + no + txt + "</div>";
//    textTipsIndex = layer.tips(txt, this, {
//      time: 0,
//      area: ['500px']
 //   });
    $('#copy-input').remove();
    return $('body').append(html);
  });

  var copyFun = function (obj){
    var str = "点击复制",
        strHtml = obj.html().toString().replace("复制文案",str);
    obj.html(strHtml);

    if(obj.find('.copyText').length>0){
      resetleft(obj.find('.copyText'));
    }else{
      var url='/?g=tbkqq&m=cuntao&a=gettpl&id='+ obj.siblings('.go_info').data('gid') ;
      $.ajax({
        type:'get',
        url:url,
        cache:false,
        success:function(res){
          obj.append('<div class="copyText">'+res+'</div>');
          // obj.find('img').attr('src',obj.siblings('a').find('img').attr('src'));
          resetleft(obj.find('.copyText'));
        },
        errer:function(){
        }
      });
    }
  }

  $('.body').mouseleave(function() {
//    layer.close(textTipsIndex);
    return;
  });
});




